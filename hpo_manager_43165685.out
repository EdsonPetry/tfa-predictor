Job started at Thu Apr 24 11:42:30 EDT 2025
Running on host: slepner087.amarel.rutgers.edu
SLURM job ID: 43165685
PYTHONPATH set to: :/home/elp95/tfa-predictor
Python executable: /cache/home/elp95/tfa-predictor/.venv/bin/python
Python version: Python 3.12.3
Current directory: /home/elp95/tfa-predictor
Contents of data directory:
total 121571
drwxrwxr-x  6 elp95 elp95      4096 Apr 20 13:33 .
drwxrwxr-x 15 elp95 elp95      4096 Apr 24 11:42 ..
drwxrwxr-x  5 elp95 elp95      4096 Apr 20 13:31 gene-xprs
drwxrwxr-x  2 elp95 elp95      4096 Apr 20 13:33 old
drwxrwxr-x  2 elp95 elp95      4096 Apr 20 13:29 __pycache__
-rw-rw-r--  1 elp95 elp95 124474679 Apr 20 13:30 pysnailed_no_jm.tsv
drwxrwxr-x  6 elp95 elp95      4096 Apr 20 13:32 tfa
Starting HPO campaign...
2025-04-24 11:42:31,976 - hpo_campaign - INFO - Starting HPO campaign with config: hpo.config.mlp_config
2025-04-24 11:42:31,978 - amarel_async_search - INFO - Initialized AmarelAsyncRandomSearch with output_dir=/home/elp95/tfa-predictor/hpo_results/mlp
2025-04-24 11:42:31,978 - amarel_async_search - INFO - Configuration space: {'input_size': 3883, 'output_size': 214, 'hidden_sizes': [[1024, 512, 256], [2048, 1024, 512], [2048, 1024, 512, 256], [512, 256, 128], [1024, 256]], 'lr': <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x7f95d5c9bec0>, 'weight_decay': <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x7f95cb18ae70>, 'batch_size': [32, 64, 128], 'max_epochs': [50, 100, 200]}
2025-04-24 11:42:31,978 - hpo_campaign - INFO - Found checkpoint to resume from: /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_9.pkl
2025-04-24 11:42:31,979 - amarel_async_search - INFO - Loaded checkpoint from /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_9.pkl
2025-04-24 11:42:31,980 - amarel_async_search - INFO - Restored 9 completed trials
2025-04-24 11:42:31,980 - amarel_async_search - INFO - Best error so far: 0.0237816891943415
2025-04-24 11:42:31,980 - amarel_async_search - INFO - Starting asynchronous random search for 30 trials
2025-04-24 11:42:31,980 - amarel_async_search - INFO - Maximum concurrent jobs: 8
2025-04-24 11:42:32,012 - amarel_async_search - INFO - Job 607cd0fd-4223-442c-ad3a-cefbf5ec1598 no longer in SLURM memory (likely completed)
2025-04-24 11:42:32,012 - amarel_async_search - ERROR - Results file not found for job 607cd0fd-4223-442c-ad3a-cefbf5ec1598 (trial 1)
2025-04-24 11:42:32,013 - amarel_async_search - WARNING - Job 607cd0fd-4223-442c-ad3a-cefbf5ec1598 marked as completed but couldn't process results, removing from active jobs
2025-04-24 11:42:32,045 - amarel_async_search - INFO - Job 7f2aa220-2f91-4ad4-8302-a643bc670244 no longer in SLURM memory (likely completed)
2025-04-24 11:42:32,045 - amarel_async_search - ERROR - Results file not found for job 7f2aa220-2f91-4ad4-8302-a643bc670244 (trial 4)
2025-04-24 11:42:32,045 - amarel_async_search - WARNING - Job 7f2aa220-2f91-4ad4-8302-a643bc670244 marked as completed but couldn't process results, removing from active jobs
2025-04-24 11:42:32,078 - amarel_async_search - INFO - Job 8c2a4d12-a6c9-4ad5-914f-2f042397d5e8 no longer in SLURM memory (likely completed)
2025-04-24 11:42:32,079 - amarel_async_search - ERROR - Results file not found for job 8c2a4d12-a6c9-4ad5-914f-2f042397d5e8 (trial 6)
2025-04-24 11:42:32,079 - amarel_async_search - WARNING - Job 8c2a4d12-a6c9-4ad5-914f-2f042397d5e8 marked as completed but couldn't process results, removing from active jobs
2025-04-24 11:42:32,083 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_10.pkl
2025-04-24 11:42:32,085 - amarel_async_search - INFO - Processed results for job 6beb9844-7018-4d2f-b83e-6dcc35af31ab (trial 7): error=0.07078146632938158
2025-04-24 11:42:32,088 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_11.pkl
2025-04-24 11:42:32,090 - amarel_async_search - INFO - Processed results for job a1ce93b3-dc25-4dcf-8ac3-1ac855fc06b3 (trial 11): error=0.02933283912187273
2025-04-24 11:42:32,095 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_12.pkl
2025-04-24 11:42:32,097 - amarel_async_search - INFO - Processed results for job 3a3d11b0-7408-40c8-b3c3-6434a5e33ee0 (trial 12): error=0.029896348376165737
2025-04-24 11:42:32,101 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_13.pkl
2025-04-24 11:42:32,102 - amarel_async_search - INFO - Processed results for job aa537217-d369-4496-8e44-2d2e9610cd2a (trial 13): error=0.07979721017181873
2025-04-24 11:42:32,105 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_14.pkl
2025-04-24 11:42:32,107 - amarel_async_search - INFO - Processed results for job 578bf2fa-25b6-4420-94b0-6ee0b69c1f5e (trial 14): error=0.1001010997728868
2025-04-24 11:42:32,107 - amarel_async_search - INFO - Removing job 607cd0fd-4223-442c-ad3a-cefbf5ec1598 from active jobs
2025-04-24 11:42:32,107 - amarel_async_search - INFO - Removing job 7f2aa220-2f91-4ad4-8302-a643bc670244 from active jobs
2025-04-24 11:42:32,107 - amarel_async_search - INFO - Removing job 8c2a4d12-a6c9-4ad5-914f-2f042397d5e8 from active jobs
2025-04-24 11:42:32,142 - amarel_async_search - INFO - Submitted SLURM job 43165686 for trial 15
2025-04-24 11:42:32,175 - amarel_async_search - INFO - Submitted SLURM job 43165687 for trial 16
2025-04-24 11:42:32,209 - amarel_async_search - INFO - Submitted SLURM job 43165688 for trial 17
2025-04-24 11:42:32,243 - amarel_async_search - INFO - Submitted SLURM job 43165689 for trial 18
2025-04-24 11:42:32,274 - amarel_async_search - INFO - Submitted SLURM job 43165690 for trial 19
2025-04-24 11:42:32,307 - amarel_async_search - INFO - Submitted SLURM job 43165691 for trial 20
2025-04-24 11:42:32,340 - amarel_async_search - INFO - Submitted SLURM job 43165692 for trial 21
2025-04-24 11:42:32,373 - amarel_async_search - INFO - Submitted SLURM job 43165693 for trial 22
2025-04-24 11:42:32,373 - amarel_async_search - INFO - Status: 14/30 trials completed, 8 jobs active, best error: 0.0237816891943415, elapsed: 608696.0s
2025-04-24 11:42:37,391 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_15.pkl
2025-04-24 11:42:37,405 - amarel_async_search - INFO - Processed results for job 43165686 (trial 15): error=0.051028659397905525
2025-04-24 11:42:37,415 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_16.pkl
2025-04-24 11:42:37,422 - amarel_async_search - INFO - Processed results for job 43165687 (trial 16): error=0.23222910003228622
2025-04-24 11:42:37,427 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_17.pkl
2025-04-24 11:42:37,430 - amarel_async_search - INFO - Processed results for job 43165688 (trial 17): error=0.030307520180940628
2025-04-24 11:42:37,434 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_18.pkl
2025-04-24 11:42:37,438 - amarel_async_search - INFO - Processed results for job 43165689 (trial 18): error=0.03761079800980432
2025-04-24 11:42:37,443 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_19.pkl
2025-04-24 11:42:37,445 - amarel_async_search - INFO - Processed results for job 43165690 (trial 19): error=0.036454598197624796
2025-04-24 11:42:37,450 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_20.pkl
2025-04-24 11:42:37,452 - amarel_async_search - INFO - Processed results for job 43165691 (trial 20): error=0.032772094898280646
2025-04-24 11:42:37,457 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_21.pkl
2025-04-24 11:42:37,459 - amarel_async_search - INFO - Processed results for job 43165692 (trial 21): error=0.08040022632728021
2025-04-24 11:42:37,473 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_22.pkl
2025-04-24 11:42:37,476 - amarel_async_search - INFO - Processed results for job 43165693 (trial 22): error=0.026287981619437534
2025-04-24 11:42:37,510 - amarel_async_search - INFO - Submitted SLURM job 43165694 for trial 23
2025-04-24 11:42:37,540 - amarel_async_search - INFO - Submitted SLURM job 43165695 for trial 24
2025-04-24 11:42:37,571 - amarel_async_search - INFO - Submitted SLURM job 43165696 for trial 25
2025-04-24 11:42:37,602 - amarel_async_search - INFO - Submitted SLURM job 43165697 for trial 26
2025-04-24 11:42:37,634 - amarel_async_search - INFO - Submitted SLURM job 43165698 for trial 27
2025-04-24 11:42:37,665 - amarel_async_search - INFO - Submitted SLURM job 43165700 for trial 28
2025-04-24 11:42:37,696 - amarel_async_search - INFO - Submitted SLURM job 43165701 for trial 29
2025-04-24 11:42:37,727 - amarel_async_search - INFO - Submitted SLURM job 43165702 for trial 30
2025-04-24 11:42:37,727 - amarel_async_search - INFO - Status: 22/30 trials completed, 8 jobs active, best error: 0.0237816891943415, elapsed: 608701.3s
2025-04-24 11:42:42,733 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_23.pkl
2025-04-24 11:42:42,736 - amarel_async_search - INFO - Processed results for job 43165694 (trial 23): error=0.026463891379535198
2025-04-24 11:42:42,742 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_24.pkl
2025-04-24 11:42:42,744 - amarel_async_search - INFO - Processed results for job 43165695 (trial 24): error=0.08441008627414703
2025-04-24 11:42:42,745 - amarel_async_search - INFO - New best configuration found! Error: 0.022848933257839897
2025-04-24 11:42:42,746 - amarel_async_search - INFO - Best config: {'input_size': 3883, 'output_size': 214, 'hidden_sizes': [2048, 1024, 512], 'lr': np.float64(0.0005899741796710494), 'weight_decay': np.float64(1.0762979285747974e-05), 'batch_size': np.int64(64), 'max_epochs': np.int64(200)}
2025-04-24 11:42:42,766 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_25.pkl
2025-04-24 11:42:42,768 - amarel_async_search - INFO - Processed results for job 43165696 (trial 25): error=0.022848933257839897
2025-04-24 11:42:42,774 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_26.pkl
2025-04-24 11:42:42,778 - amarel_async_search - INFO - Processed results for job 43165697 (trial 26): error=0.06227093500395616
2025-04-24 11:42:42,783 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_27.pkl
2025-04-24 11:42:42,786 - amarel_async_search - INFO - Processed results for job 43165698 (trial 27): error=0.04441779820869366
2025-04-24 11:42:42,838 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_28.pkl
2025-04-24 11:42:42,841 - amarel_async_search - INFO - Processed results for job 43165700 (trial 28): error=0.03223577979952097
2025-04-24 11:42:42,928 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608706.5s
2025-04-24 11:42:48,018 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608711.6s
2025-04-24 11:42:53,101 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608716.7s
2025-04-24 11:42:58,184 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608721.8s
2025-04-24 11:43:03,265 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608726.9s
2025-04-24 11:43:08,346 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608731.9s
2025-04-24 11:43:13,432 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608737.0s
2025-04-24 11:43:18,516 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608742.1s
2025-04-24 11:43:23,601 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608747.2s
2025-04-24 11:43:28,684 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608752.3s
2025-04-24 11:43:33,768 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608757.4s
2025-04-24 11:43:38,848 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608762.4s
2025-04-24 11:43:43,928 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608767.5s
2025-04-24 11:43:49,012 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608772.6s
2025-04-24 11:43:54,093 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608777.7s
2025-04-24 11:43:59,173 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608782.8s
2025-04-24 11:44:04,251 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608787.9s
2025-04-24 11:44:09,334 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608792.9s
2025-04-24 11:44:14,420 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608798.0s
2025-04-24 11:44:19,501 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608803.1s
2025-04-24 11:44:24,582 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608808.2s
2025-04-24 11:44:29,672 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608813.3s
2025-04-24 11:44:34,853 - amarel_async_search - INFO - Status: 28/30 trials completed, 2 jobs active, best error: 0.022848933257839897, elapsed: 608818.5s
2025-04-24 11:44:39,859 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_29.pkl
2025-04-24 11:44:39,890 - amarel_async_search - INFO - Processed results for job 43165701 (trial 29): error=0.13949184661561792
2025-04-24 11:44:39,932 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608823.5s
2025-04-24 11:44:44,972 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608828.6s
2025-04-24 11:44:50,013 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608833.6s
2025-04-24 11:44:55,053 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608838.7s
2025-04-24 11:45:00,092 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608843.7s
2025-04-24 11:45:05,944 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608849.5s
2025-04-24 11:45:10,990 - amarel_async_search - INFO - Status: 29/30 trials completed, 1 jobs active, best error: 0.022848933257839897, elapsed: 608854.6s
2025-04-24 11:45:15,995 - amarel_async_search - INFO - Saved checkpoint to /home/elp95/tfa-predictor/hpo_results/mlp/checkpoints/checkpoint_30.pkl
2025-04-24 11:45:15,997 - amarel_async_search - INFO - Processed results for job 43165702 (trial 30): error=0.1416675920287768
2025-04-24 11:45:15,997 - amarel_async_search - INFO - Status: 30/30 trials completed, 0 jobs active, best error: 0.022848933257839897, elapsed: 608859.6s
2025-04-24 11:45:20,998 - amarel_async_search - INFO - Search completed, best error: 0.022848933257839897
2025-04-24 11:45:20,998 - amarel_async_search - INFO - Best config: {'input_size': 3883, 'output_size': 214, 'hidden_sizes': [2048, 1024, 512], 'lr': np.float64(0.0005899741796710494), 'weight_decay': np.float64(1.0762979285747974e-05), 'batch_size': np.int64(64), 'max_epochs': np.int64(200)}
2025-04-24 11:45:21,020 - hpo_campaign - ERROR - Error running HPO campaign: Object of type int64 is not JSON serializable
Traceback (most recent call last):
  File "/cache/home/elp95/tfa-predictor/hpo/main_hpo.py", line 109, in run_hpo_campaign
    results = scheduler.run_hpo_campaign(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cache/home/elp95/tfa-predictor/hpo/Scheduler.py", line 172, in run_hpo_campaign
    json.dump({
  File "/home/elp95/miniconda3/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/cache/home/elp95/tfa-predictor/hpo/main_hpo.py", line 142, in <module>
    main()
  File "/cache/home/elp95/tfa-predictor/hpo/main_hpo.py", line 138, in main
    run_hpo_campaign(args.config)
  File "/cache/home/elp95/tfa-predictor/hpo/main_hpo.py", line 109, in run_hpo_campaign
    results = scheduler.run_hpo_campaign(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cache/home/elp95/tfa-predictor/hpo/Scheduler.py", line 172, in run_hpo_campaign
    json.dump({
  File "/home/elp95/miniconda3/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/home/elp95/miniconda3/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type int64 is not JSON serializable
HPO campaign completed at Thu Apr 24 11:45:21 EDT 2025
